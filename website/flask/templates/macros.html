<!-- ###############################################  -->
<!-- ##### Option Column ###########################  -->
<!-- ###############################################  -->
<!-- ### Displays navigation options with icon, link, and a text description. -->
<!-- ### Used in: analyze(). -->

{% macro option_col(option, length) %}

	{% set colsize=(12/length)|int %}
	<div class="col-md-{{colsize}} text-center">
			<a class="display-1 px-5 py-4 black border-black-custom rounded d-inline-block" href="{{url_for(option['link'])}}">
				<i class="fa fa-{{option['icon']}} my-3"></i>
			</a>
		<div class="large mt-3">{{option['title']}}</div>
		<div class="light small mt-2 px-5 pb-5">{{option['description']|safe}}</div>
	</div>
	
{% endmacro %}

<!-- ###############################################  -->
<!-- ##### Dataset Radio ###########################  -->
<!-- ###############################################  -->
<!-- ### Displays dataset selection radio buttons for notebook generation. -->
<!-- ### Used in: search_data(). -->

{% macro dataset_radio(dataset, i) %}

	{% set id = dataset['gse']+'-'+dataset['gpl'] %}

	<div class="row">
		<div class="col-12">
			<div data-toggle="collapse" data-target="#{{id}}-info" class="object-label mt-3 mb-0 px-3 py-3 w-100 border-custom rounded cursor-pointer bg-lightgrey">
				<div class="row">
					<div class="col-1 my-auto">
						<img src="{{ url_for('static', filename='img/dataset_icon.png') }}" class="w-100">
					</div>
					<div class="col-11">
						<div class="very-small regular pb-2 pr-5">{{ dataset['title']|safe }}</div>
						<div class="row tiny light text-muted">
							<div class="col-2"><span></span><span class="font-italic">{{dataset['gse']}}</span></div>
							<div class="col-2"><span class="font-italic">{{dataset['nr_samples']}} samples</span></div>
							<!-- <div class="col-3"><span>Organism: </span><span class="font-italic">{{dataset['organism']}}</span></div> -->
							<div class="col-3"><span>Published </span><span class="font-italic">{{dataset['date'].strftime('%B %Y')}}</span></div>
						</div>
					</div>
				</div>
			</div>
			<div id="{{id}}-info" class="collapse border-grey mx-2 border-top-0 rounded-bottom tiny {{ 'show' if i == 1 else '' }}">
				<div class="py-3">

					<!-- Summary -->
					<div class="row px-3">
						<div class="col-1 bold">Summary</div>
						<div class="col-11 text-muted light pl-4">{{ dataset['summary']|safe }}</div>
					</div>

					<!-- Organism -->
					<div class="row px-3 pt-3">
						<div class="col-1 bold">Organism</div>
						<div class="col-11 text-muted light pl-4 font-italic">{{ dataset['organism'].replace('Human', 'Homo sapiens').replace('Mouse', 'Mus musculus') }}</div>
					</div>

					<!-- Source -->
					<div class="row px-3 pt-3">
						<div class="col-1 bold">Source</div>
						<div class="col-6 text-muted light pl-4"><a target="_blank" href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc={{ dataset['gse'] }}">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc={{ dataset['gse'] }}</a></div>
					</div>

					<!-- Repository -->
					<div class="row px-3 pt-3">
						<div class="col-1 bold">Repository</div>
						<div class="col-11 text-muted light pl-4"><a target="_blank" href="https://www.ncbi.nlm.nih.gov/gds">Gene Expression Omnibus</a></div>
					</div>

					<!-- Analyze -->
					<div class="row px-3 pt-3 analyze-col float-right">
						<div class="col-12">
							<form id="{{id}}-form">
								<input type="hidden" name="gse-gpl" value="{{id}}">
							</form>
							<button class="btn white bg-white nodecoration border-custom px-3 py-2 small regular bg-blue" form="{{id}}-form" type="submit" formaction="{{ url_for('add_tools') }}" formmethod="post">Analyze<i class="fa fa-angle-right ml-2"></i></button>
						</div>
					</div>


				</div>
			</div>
		</div>
	</div>

{% endmacro %}

<!-- ###############################################  -->
<!-- ##### Tool Checkbox ###########################  -->
<!-- ###############################################  -->
<!-- ### Displays tool selection options for notebook generation. -->
<!-- ### Used in: add_tools(). -->

{% macro tool_checkbox(tool, version) %}

	<div class="row">
		<div class="col-12">
			<input type="checkbox" name="tool" id="{{tool['tool_string']}}" value="{{tool['tool_string']}}" {{'checked' if tool['default_selected'] else ''}} class="hidden">
			<div class="object-label mt-3 mb-0 px-3 py-3 w-100 border-custom rounded cursor-pointer bg-lightgrey" data-toggle="collapse" data-target="#{{tool['tool_string']}}-info">
				<div class="row">

					<!-- Icon -->
					<div class="col-1">
						<img src="{{ url_for('static', filename='img/tool/{tool_string}/{tool_string}.png'.format(**tool)) }}" class="w-100 px-1 py-1 rounded bg-white border-grey">
					</div>

					<!-- Info -->
					<div class="col-10">
						<div class="very-small regular pb-2 pr-5">{{tool['tool_name']|safe}}</div>
						<div class="tiny light text-muted"><span>{{tool['tool_description']}}</span></div>
					</div>

					<!-- Checkbox -->
					<div class="col-1 my-auto text-center">
						<label for="{{tool['tool_string']}}" class="my-auto"><i class="far fa-2x tool-checkbox"></i></label>
					</div>

				</div>
			</div>
			<div id="{{tool['tool_string']}}-info" class="collapse border-grey mx-2 border-top-0 rounded-bottom tiny {{ 'show' if tool['tool_string'] == '' else '' }}">
				<div class="row py-3 px-3">

					<!-- Screenshot -->
					<div class="col-4 my-auto">
						<div class="pop cursor-pointer">
							<img src="{{ url_for('static', filename='img/tool/{tool_string}/{tool_string}-example.png'.format(**tool)) }}" class="w-100">
						</div>
						<div class="text-center tiny light mt-3">Screenshot from a sample analysis</div>
					</div>
					<div class="col-8 text-muted light pl-4">

						<!-- Overview -->
						<div class="tiny bold">What
							{% if tool['tool_string'] in ['signature_table', 'volcano_plot', 'ma_plot']%}
								is a
							{% else %}
								is
							{% endif %}
							{{ tool['tool_name'].replace(' Links', '').replace(' Query', '')|safe }}?
						</div>
						<div class="micro mt-1 text-justify">{{tool['overview']|safe}}</div>

						<!-- Results -->
						<div class="tiny bold mt-3">Overview</div>
						<div class="micro mt-1 text-justify">{{tool['result_description']|safe}}</div>

						<!-- Reference -->
						{% if tool['reference'] %}
							<div class="tiny bold mt-3">Reference</div>
							<div><a class="nodecoration" href="{{ tool['reference_link'] }}">{{ tool['reference']|safe }}</a></div>
						{% endif %}

						<!-- Icons -->
						<div class="row mt-4">

							<!-- Example -->
							<div class="col-4 text-left">
								<a href="#" class="grey nodecoration bold mr-4" target="_blank">
									<i class="fa fa-book fa-2x align-middle mr-2"></i>Interactive Example
								</a>
							</div>

							<!-- Tutorial -->
							<div class="col-4 text-left">
								<a href="#" class="grey nodecoration bold mr-4" target="_blank">
									<i class="fab fa-youtube fa-2x align-middle mr-2"></i>Video Tutorial
								</a>
							</div>

							<!-- Source Code -->
							<div class="col-4 text-left">
								<a href="https://github.com/MaayanLab/notebook-generator/tree/master/library/{{version}}/analysis_tools/{{tool['tool_string']}}" class="grey nodecoration bold mr-4" target="_blank">
									<i class="fab fa-github fa-2x align-middle mr-2"></i>Source Code
								</a>
							</div>
						</div>

					</div>
				</div>
			</div>
		</div>
	</div>

{% endmacro %}

<!-- ###############################################  -->
<!-- ##### Parameters Card #########################  -->
<!-- ###############################################  -->
<!-- ### Displays tool paremeter card for notebook generation. -->
<!-- ### Used in: configure_analysis(). -->

{% macro parameter_card(tool) %}

	<div class="row">
		<div class="col-12">
			<div class="mt-3 mb-0 px-3 py-3 w-100 border-custom rounded cursor-pointer bg-lightgrey" data-toggle="collapse" data-target="#{{tool.tool_string}}-info">
				<div class="row">
					<div class="col-1">
						<img src="{{ url_for('static', filename='img/tool/{tool_string}/{tool_string}.png'.format(**tool)) }}" class="w-100 px-1 py-1 rounded bg-white border-grey">
					</div>
					<div class="col-11">
						<div class="very-small regular pb-2 pr-5">{{tool.tool_name}}</div>
						<div class="tiny light text-muted">Optional configuration parameters for {{tool.tool_name}}</div>
					</div>
				</div>
			</div>
			<div id="{{tool.tool_string}}-info" class="collapse border-grey mx-2 border-top-0 rounded-bottom tiny">
				<div class="pt-3">
					{% for parameter in tool.parameters %}
						<div class="row px-3 pb-3">
							<div class="col-2 px-2 bold text-right tiny my-auto">
								<div>{{parameter.parameter_name}}<sup><i class="fa fa-question-circle ml-1" data-toggle="tooltip" title="{{parameter.parameter_description}}."></i></sup>:</div>
							</div>
							<div class="col-3">
								<select name="{{tool.tool_string}}-{{parameter.parameter_string}}" class="form-control nodecoration tiny bg-white px-2 py-1">
									{% for value in parameter['values'] %}
										<option class="px-2 py-1" value="{{value.value}}" {{'selected' if value.default else ''}}>{{value.value}}</option>
									{% endfor %}
								</select>
							</div>
						</div>
					{% endfor %}
				</div>
			</div>
		</div>
	</div>

{% endmacro %}

<!-- ###############################################  -->
<!-- ##### Notebook Settings Card ##################  -->
<!-- ###############################################  -->
<!-- ### Displays notebook configuration card. -->
<!-- ### Used in: configure_analysis(). -->

{% macro notebook_settings(gse, group_a_label, group_b_label) %}

	<div class="row">
		<div class="col-12">
			<div class="mt-3 mb-0 px-3 py-3 w-100 border-custom rounded cursor-pointer bg-lightgrey" data-toggle="collapse" data-target="#notebook_settings-info">
				<div class="row">
					<div class="col-1">
						<img src="{{ url_for('static', filename='img/jupyter.png') }}" class="w-100 px-1 py-1 rounded bg-white border-grey">
					</div>
					<div class="col-11">
						<div class="very-small regular pb-2 pr-5">Notebook Configuration</div>
						<div class="tiny light text-muted">Optional annotations and configuration for the notebook</div>
					</div>
				</div>
			</div>
			<div id="notebook_settings-info" class="collapse show border-grey mx-2 border-top-0 rounded-bottom tiny">
				<div class="pt-3">
					<div class="row px-3 pb-3">
						<div class="col-2 bold text-right my-auto">
							<div>Notebook Title<sup><i class="fa fa-question-circle ml-1" data-toggle="tooltip" title="Name of the Jupyter Notebook."></i></sup>:</div>
						</div>
						<div class="col-5">
							<input class="form-control tiny nodecoration" type="text" name="notebook_title" value="{{ ' vs '.join([group_a_label, group_b_label]) if group_a_label and group_b_label else gse }} Analysis Notebook | BioJupies">
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

{% endmacro %}

