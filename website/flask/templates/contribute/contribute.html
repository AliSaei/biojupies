{% extends 'base.html' %}
{% import 'macros.html' as macros %}

{% block head %}
	<title>BioJupies | Contribute</title>
	<style type="text/css">html{height: 100%;}body{height: 100%; overflow: hidden;}#outer-container{height: 100%;}</style>
{% endblock %}

{% block content %}

<div class="px-6">
	<div class="row">
		<div class="col-8 large mt-4 pl-4">Contribute a Plug-in</sup></div>
	</div>
	<div class="row">
		<hr width="100%" class="mt-3 mb-0">
		<div class="col-12 px-4 pt-4 very-small">
			<div>Contribute your computational tool as a plug-in to BioJupies to allow other users to use it for notebook generation.</div>
			<div>We currently only support plug-ins in Python and R. These should be uploaded as a single .py or .R file.  This file should contain two functions: run() and plot().</div>
			<div>run() runs the analysis.</div>
			<div>plot() plots the analysis results in a way which is embeddable in a Jupyter Notebook.</div>
			<form id="contribute-form" action="{{ url_for('contribute') }}" method="post">
				<div>
					<input type="text" placeholder="Insert plug-in name" name="title" required="true" value="Tool">
				</div>
				<div>
					<input type="text" placeholder="Insert plug-in description" name="description" required="true" value="Description">
				</div>
				<div>
					<input type="email" placeholder="Insert email" name="email" required="true" value="a@b.c">
				</div>
				<div>
					<input type="hidden" name="filename" value="">
					<input type="hidden" name="file" value="">
					<input type="hidden" name="extension" value="">
				</div>
				<div>
					<div id="dropzone" class="dropzone border-grey rounded"></div>
				</div>
				<input type="submit" value="Submit">
			</form>

		</div>
	</div>
</div>

{% endblock %}

{% block footer %}
<script type="text/javascript">

$("#dropzone").dropzone({ 
	// dictDefaultMessage: "Click h",
	url: "{{ url_for('contribute_api') }}",
    success: function(file, response){

    	// Read Response
    	response = JSON.parse(response);

    	// Add File
    	$('[name="filename"]').val(response['filename']);
    	$('[name="file"]').val(response['file']);
    	$('[name="extension"]').val(response['extension']);

    }
});

$('#contribute-form').submit(function(evt) {
	if ($('[name="file-txt"]').val().length) {
	} else {
		evt.preventDefault();
		alert('Please upload a script file using the form below.')
	}
})

</script>
{% endblock %}