{% extends 'base.html' %}
{% import 'macros.html' as macros %}

{% block head %}
<title>Notebook Generator | Upload</title>
{% endblock %}

{% block content %}

<div class="container">
	<div class="row">
		<div class="col-8 large mt-5 pl-4">Upload Data</div>
	</div>
	<div class="row">
		<hr width="100%">
		<div class="col-12 text-center pb-5" style="overflow: hidden;">
			<div id="status" class="mt-5 medium">Launching alignment jobs...</div>
			<div id="info" class="mt-4 very-small">You will be redirected shortly.</div>
			<div class="loader">Loading...</div>
			<input type="hidden" id="data" value="{{f}}">
		</div>
	</div>
</div>

{% endblock %}


{% block footer %}

<script type="text/javascript">

	$.ajax({
		url: "{{ url_for('alignment_api') }}",
		method: "POST",
		data: $('#data').val(),
		contentType: "application/json; charset=utf-8",
		dataType: 'json',
		success: function(res) {
			console.log(res);
		},
		error: function(e) {
			$('#status').html('Sorry, there has been an error.');
			$('#info').hide();
			$('.loader').hide();
			console.log(e);
		}
	})

	function sleep(ms) {
	  return new Promise(resolve => setTimeout(resolve, ms));
	}

	async function demo() {
	  await sleep(5000);
		window.location.replace('{{ url_for("upload_reads", uid=dataset_uid) }}')
	}

	demo();

</script>

{% endblock %}
